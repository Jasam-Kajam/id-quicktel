<!DOCTYPE html>
<html>
<head>
  <title>GasHub Marketplace</title>
</head>

<body>

<h2>GasHub Marketplace</h2>

<input id="title" placeholder="Cylinder title">
<button onclick="addListing()">Post Listing</button>

<ul id="list"></ul>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs } 
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBHxLJOZ5bdApAhSKOn2v9GtgrbsIxK_6A",
  authDomain: "gashub-917f2.firebaseapp.com",
  projectId: "gashub-917f2",
  storageBucket: "gashub-917f2.firebasestorage.app",
  messagingSenderId: "738809329471",
  appId: "1:738809329471:web:8cde88a1ee187b1971c58a",
  measurementId: "G-V0VZHX3JBF"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Add listing
window.addListing = async function() {
  const title = document.getElementById("title").value;

  await addDoc(collection(db, "listings"), {
    title: title,
    created: Date.now()
  });

  loadListings();
}

// Load listings
async function loadListings(){
  const querySnapshot = await getDocs(collection(db,"listings"));
  const list = document.getElementById("list");

  list.innerHTML = "";

  querySnapshot.forEach(doc=>{
    list.innerHTML += `<li>${doc.data().title}</li>`;
  });
}

loadListings();

</script>

</body>
</html>